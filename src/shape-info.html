<link rel="import" href="intertext-draggable.html">
<link rel="import" href="intertext-resizeable.html">
<link rel="import" href="intertext-rotatable.html">

<dom-module id="shape-info">
    <template>
        <style>
            :host {
                display: block;
                position: absolute;
                top: 0;
                left: 0;
            }
        </style>
        <intertext-draggable id="drag" position="[[input.position]]" on-move="handleMove">
            <intertext-resizeable id="resize" scale="[[input.scale]]" on-scale="handleScale">
                <intertext-rotatable id="rot" rotation="[[input.rotation]]" on-rotate="handleRotate">
                    <slot></slot>
                </intertext-rotatable>
            </intertext-resizeable>
        </intertext-draggable>
    </template>
    <script>
        class ShapeInfo extends Polymer.Element {
            static get is() {
                return "shape-info";
            }

            static get config() {
                return {
                    properties: {
                        input: {
                            type: Object
                        },
                        key: {
                            type: Object,
                        },
                    }
                };
            }

            scaleAlittle(value) {
                if (!this.input.scale || this.input.scale < 0)
                    this.input.scale = 1;
                this.input.scale += value;
                this.notifyChange();
            }

            rotateAlittle(value) {
                if (!this.input.rotation)
                    this.input.rotation = 0;
                this.input.rotation += value;
                this.notifyChange();
            }

            notifyChange() {
//                this.notifyPath("input"); //needed to update the draggable, rotatable, resizeable.
                this.dispatchEvent(new CustomEvent("newinfo", {detail: {key: this.key, value: this.input}}));
            }

            handleMove(e, detail) {
                this.input.position = detail;
                this.notifyChange();
            }

            handleScale(e, detail) {
                this.input.scale = detail;
                this.notifyChange();
            }

            handleRotate(e, detail) {
                this.input.rotation = detail;
                this.notifyChange();
            }
        }
        customElements.define(ShapeInfo.is, ShapeInfo);
    </script>
</dom-module>
